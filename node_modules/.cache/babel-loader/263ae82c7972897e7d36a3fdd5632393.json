{"ast":null,"code":"import _regeneratorRuntime from\"G:\\\\MERN\\\\keeper\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"G:\\\\MERN\\\\keeper\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"G:\\\\MERN\\\\keeper\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Paper,Step,StepLabel,Typography,CircularProgress,Divider,Button,Stepper,CssBaseline}from\"@material-ui/core\";import useStyles from\"./styles\";import AddressForm from\"../AddressForm\";import PaymentForm from\"../PaymentForm\";import{commerce}from\"../../../lib/commerce\";import{Link,useHistory}from\"react-router-dom\";const Checkout=({cart,order,error,onCaptureCheckout})=>{const classes=useStyles();const _useState=useState(0),_useState2=_slicedToArray(_useState,2),activeStep=_useState2[0],setActiveStep=_useState2[1];const steps=[' Shipping Address ','Payment'];const history=useHistory();const _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),checkoutToken=_useState4[0],setcheckoutToken=_useState4[1];const _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),shippingData=_useState6[0],setshippingData=_useState6[1];const _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),finished=_useState8[0],setFinished=_useState8[1];useEffect(()=>{const generateToken=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var token;return _regeneratorRuntime.wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return commerce.checkout.generateToken(cart.id,{type:'cart'});case 3:token=_context.sent;setcheckoutToken(token);console.log(token);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);if(activeStep!==steps.length)history.push('/');case 11:case\"end\":return _context.stop();}},_callee,null,[[0,8]]);}));return function generateToken(){return _ref.apply(this,arguments);};}();generateToken();},[cart]);const timeout=()=>{setTimeout(()=>{setFinished(true);},2000);};let Confirmation=()=>order.customer?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Typography,{variant:\"h5\"},\"Thank You for you purchase, \",order.customer.firstname,\" \",order.customer.lastname),/*#__PURE__*/React.createElement(Divider,null),/*#__PURE__*/React.createElement(Typography,null,\"order ref :\",order.customer_reference)),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(Button,{component:Link,to:\"/\",variant:\"outlined\",type:\"button\"},\"Back to home\")):finished?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Typography,{variant:\"h5\"},\"Thank You for you purchase\"),/*#__PURE__*/React.createElement(Divider,null)),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(Button,{component:Link,to:\"/\",variant:\"outlined\",type:\"button\"},\"Back to home\")):/*#__PURE__*/React.createElement(\"div\",{className:classes.spinner},/*#__PURE__*/React.createElement(CircularProgress,null));/*if(error)\r\n        {\r\n            Confirmation=()=>(\r\n            <>\r\n            <Typography>Error:{error}</Typography>\r\n            <Button component={Link} to=\"/\" variant=\"outlined\" type=\"button\">Back to home</Button>\r\n\r\n            </>\r\n            )\r\n        }\r\n    */const nextStep=()=>{setActiveStep(prevStep=>prevStep+1);};const backStep=()=>{setActiveStep(prevStep=>prevStep-1);};const next=data=>{setshippingData(data);nextStep();};const Form=()=>activeStep===0?/*#__PURE__*/React.createElement(AddressForm,{checkoutToken:checkoutToken,next:next}):/*#__PURE__*/React.createElement(PaymentForm,{nextStep:nextStep,backStep:backStep,onCaptureCheckout:onCaptureCheckout,checkoutToken:checkoutToken,shippingData:shippingData,timeout:timeout});return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(CssBaseline,null),/*#__PURE__*/React.createElement(\"div\",{className:classes.toolbar}),/*#__PURE__*/React.createElement(\"main\",{className:classes.layout},/*#__PURE__*/React.createElement(Paper,null,/*#__PURE__*/React.createElement(Typography,{variant:\"h4\"},\" Checkout\"),/*#__PURE__*/React.createElement(Stepper,{activeStep:activeStep,className:classes.stepper},steps.map(step=>/*#__PURE__*/React.createElement(Step,{key:step},/*#__PURE__*/React.createElement(StepLabel,null,step)))),activeStep===steps.length?/*#__PURE__*/React.createElement(Confirmation,null):checkoutToken&&/*#__PURE__*/React.createElement(Form,null))));};export default Checkout;","map":{"version":3,"sources":["G:/MERN/keeper/src/components/CheckoutForm/Checkout/Checkout.jsx"],"names":["React","useState","useEffect","Paper","Step","StepLabel","Typography","CircularProgress","Divider","Button","Stepper","CssBaseline","useStyles","AddressForm","PaymentForm","commerce","Link","useHistory","Checkout","cart","order","error","onCaptureCheckout","classes","activeStep","setActiveStep","steps","history","checkoutToken","setcheckoutToken","shippingData","setshippingData","finished","setFinished","generateToken","checkout","id","type","token","console","log","length","push","timeout","setTimeout","Confirmation","customer","firstname","lastname","customer_reference","spinner","nextStep","prevStep","backStep","next","data","Form","toolbar","layout","stepper","map","step"],"mappings":"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","sourcesContent":["import React ,{useState,useEffect} from \"react\"\r\nimport {Paper, Step,StepLabel,Typography,CircularProgress, Divider ,Button ,Stepper,CssBaseline} from \"@material-ui/core\"\r\nimport useStyles from \"./styles\"\r\nimport AddressForm from \"../AddressForm\"\r\nimport PaymentForm from \"../PaymentForm\"\r\nimport {commerce } from \"../../../lib/commerce\"\r\nimport {Link, useHistory} from \"react-router-dom\"\r\n\r\nconst Checkout=({cart, order, error, onCaptureCheckout})=>{\r\n    const classes=useStyles();\r\n    const [activeStep,setActiveStep]=useState(0)\r\n    const steps=[' Shipping Address ','Payment']\r\n    const history=useHistory()\r\n    const [checkoutToken,setcheckoutToken]=useState(null)\r\n    const [shippingData, setshippingData]=useState({})\r\n    const[finished, setFinished]=useState(false)\r\n\r\n\r\nuseEffect(()=>{\r\n    \r\n    const generateToken=async()=>{\r\n        try {\r\n            const token=await commerce.checkout.generateToken(cart.id,{type:'cart'})\r\n            setcheckoutToken(token)\r\n            console.log(token)\r\n\r\n            \r\n        } catch (error) {\r\n            if (activeStep !== steps.length) history.push('/');           \r\n        }\r\n\r\n    }\r\n\r\n    generateToken();\r\n},[cart])\r\n\r\n\r\nconst timeout=()=>{\r\n    setTimeout(()=>{\r\n        setFinished(true)\r\n\r\n    },2000)\r\n}\r\n    let Confirmation=()=> \r\n        \r\n        \r\n        (order.customer?\r\n        \r\n            (\r\n                \r\n            <>\r\n            <div>\r\n            \r\n             <Typography variant=\"h5\">Thank You for you purchase, {order.customer.firstname} {order.customer.lastname}</Typography>  \r\n             <Divider/>\r\n             <Typography>order ref :{order.customer_reference}</Typography>\r\n            </div>\r\n            <br/>\r\n            <Button component={Link} to=\"/\" variant=\"outlined\" type=\"button\">Back to home</Button>\r\n\r\n            \r\n            </>\r\n        ):finished?(\r\n            <>\r\n            <div>\r\n            \r\n             <Typography variant=\"h5\">Thank You for you purchase</Typography>  \r\n             <Divider/>\r\n            \r\n            </div>\r\n            <br/>\r\n            <Button component={Link} to=\"/\" variant=\"outlined\" type=\"button\">Back to home</Button>\r\n\r\n            \r\n            </>\r\n\r\n        ):\r\n         (\r\n            <div className={classes.spinner}>\r\n            <CircularProgress/>\r\n            </div>\r\n        )\r\n        )\r\n\r\n        /*if(error)\r\n        {\r\n            Confirmation=()=>(\r\n            <>\r\n            <Typography>Error:{error}</Typography>\r\n            <Button component={Link} to=\"/\" variant=\"outlined\" type=\"button\">Back to home</Button>\r\n\r\n            </>\r\n            )\r\n        }\r\n    */\r\n\r\n    const nextStep=()=>{\r\n        setActiveStep((prevStep)=>prevStep+1)\r\n    }\r\n\r\n    const backStep=()=>{\r\n        setActiveStep((prevStep)=>prevStep-1)\r\n    }\r\n\r\n    const next=(data)=>{\r\n        setshippingData(data);\r\n        nextStep()\r\n\r\n    }\r\n\r\n    const Form=()=>(\r\n        activeStep===0?<AddressForm checkoutToken={checkoutToken}  next={next}/>:<PaymentForm \r\n        nextStep={nextStep}\r\n        backStep={backStep}\r\n         onCaptureCheckout={onCaptureCheckout} checkoutToken={checkoutToken}\r\n         shippingData={shippingData}\r\n         timeout={timeout}\r\n         />\r\n    )\r\n    return(\r\n        <>\r\n        <CssBaseline/>\r\n        <div className={classes.toolbar}/>\r\n        <main className={classes.layout}>\r\n        <Paper>\r\n            <Typography variant=\"h4\"> Checkout</Typography>\r\n            <Stepper activeStep={activeStep} className={classes.stepper}>\r\n            {steps.map((step)=>(\r\n                <Step key={step}>\r\n                    <StepLabel>{step}</StepLabel>\r\n                </Step>\r\n\r\n            ))}\r\n\r\n            </Stepper>\r\n            {activeStep===steps.length ?<Confirmation/>:checkoutToken&& <Form/>}\r\n        </Paper>\r\n\r\n      </main>\r\n        \r\n        </>\r\n    )\r\n\r\n}\r\nexport default Checkout"]},"metadata":{},"sourceType":"module"}