{"ast":null,"code":"import _regeneratorRuntime from \"G:\\\\MERN\\\\keeper\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"G:\\\\MERN\\\\keeper\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"G:\\\\MERN\\\\keeper\\\\src\\\\components\\\\CheckoutForm\\\\PaymentForm.jsx\";\nimport React from \"react\";\nimport { Divider, Typography, Button } from \"@material-ui/core\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { Elements, CardElement, ElementsConsumer } from \"@stripe/react-stripe-js\";\nimport Review from \"./Review\";\n\nconst PaymentForm = ({\n  checkoutToken,\n  backStep,\n  onCaptureCheckout,\n  nextStep\n}) => {\n  const stripePromise = loadStripe(process.env.REACT_APP_STRIPE_KEY);\n\n  const handleSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e, elements, stripe) {\n      var CardElement, _yield$stripe$createP, error, paymentMethod, orderDetail;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            e.preventDefault();\n\n            if (!(!stripe || !element)) {\n              _context.next = 3;\n              break;\n            }\n\n            return _context.abrupt(\"return\");\n\n          case 3:\n            CardElement = elements.getElement(CardElement);\n            _context.next = 6;\n            return stripe.createPaymentmethod({\n              type: 'card',\n              card: cardElement\n            });\n\n          case 6:\n            _yield$stripe$createP = _context.sent;\n            error = _yield$stripe$createP.error;\n            paymentMethod = _yield$stripe$createP.paymentMethod;\n            if (error) console.log(error);else {\n              orderDetail = {\n                line_items: checkoutToken.live.line_items,\n                customer: {\n                  firstname: shippingData.firstName,\n                  lastname: shippingData.lastName,\n                  email: shippingData.email\n                },\n                shipping: {\n                  name: 'Primary',\n                  town_city: shippingData.city,\n                  country: shippingData.shippingCountry\n                },\n                payment: {\n                  gateway: 'stripe',\n                  stripe: {\n                    payment_method_id: paymentMethod\n                  }\n                }\n              };\n            }\n            onCaptureCheckout(checkoutToken.id, orderDetail);\n            nextStep();\n\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }));\n\n    return function handleSubmit(_x, _x2, _x3) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Review, {\n    checkoutToken: checkoutToken,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Typography, {\n    variant: \"h6\",\n    gutterBottom: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 13\n    }\n  }, \"Payment Method\"), /*#__PURE__*/React.createElement(Elements, {\n    stripe: stripePromise,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ElementsConsumer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 13\n    }\n  }, ({\n    elements,\n    stripe\n  }) => /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: e => handleSubmit(e, element, stripe),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(CardElement, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"outlined\",\n    onClick: backStep,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 29\n    }\n  }, \"Back\"), /*#__PURE__*/React.createElement(Button, {\n    type: \"submit\",\n    color: \"primary\",\n    variant: \"contained\",\n    disable: !stripe,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 30\n    }\n  }, \" Pay \", checkoutToken.live.subtotal.formatted_with_symbol))))));\n};\n\nexport default PaymentForm;","map":{"version":3,"sources":["G:/MERN/keeper/src/components/CheckoutForm/PaymentForm.jsx"],"names":["React","Divider","Typography","Button","loadStripe","Elements","CardElement","ElementsConsumer","Review","PaymentForm","checkoutToken","backStep","onCaptureCheckout","nextStep","stripePromise","process","env","REACT_APP_STRIPE_KEY","handleSubmit","e","elements","stripe","preventDefault","element","getElement","createPaymentmethod","type","card","cardElement","error","paymentMethod","console","log","orderDetail","line_items","live","customer","firstname","shippingData","firstName","lastname","lastName","email","shipping","name","town_city","city","country","shippingCountry","payment","gateway","payment_method_id","id","subtotal","formatted_with_symbol"],"mappings":"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","sourcesContent":["import React from \"react\"\r\nimport {Divider, Typography, Button} from \"@material-ui/core\"\r\nimport {loadStripe} from \"@stripe/stripe-js\"\r\nimport {Elements, CardElement, ElementsConsumer} from \"@stripe/react-stripe-js\"\r\nimport Review from  \"./Review\"\r\n\r\nconst PaymentForm=({checkoutToken, backStep, onCaptureCheckout,nextStep})=>{\r\n\r\n    const stripePromise=loadStripe(process.env.REACT_APP_STRIPE_KEY)\r\n        const handleSubmit=async(e, elements,stripe)=>{\r\n            e.preventDefault()\r\n            if(!stripe || !element) return ;\r\n            const CardElement=elements.getElement(CardElement)\r\n            const{error,paymentMethod}=await stripe.createPaymentmethod({type:'card', card:cardElement})\r\n            if(error)\r\n             console.log(error)\r\n             else\r\n             {\r\n                 const orderDetail={\r\n                     line_items:checkoutToken.live.line_items,\r\n                     customer:{firstname:shippingData.firstName, lastname:shippingData.lastName, email:shippingData.email},\r\n                     shipping:{\r\n                         name:'Primary',\r\n                         town_city:shippingData.city,\r\n                         country:shippingData.shippingCountry,\r\n                     },\r\n                     payment:{\r\n                         gateway:'stripe',\r\n                         stripe:{\r\n                             payment_method_id:paymentMethod\r\n                         }\r\n                     }\r\n\r\n\r\n\r\n                 }\r\n             }\r\n\r\n             onCaptureCheckout(checkoutToken.id, orderDetail);\r\n             nextStep()\r\n        }\r\n        \r\n    \r\n    return(\r\n        <>\r\n            <Review  checkoutToken={checkoutToken}/>\r\n            <Divider/>\r\n            <Typography  variant=\"h6\" gutterBottom>\r\n                Payment Method\r\n            </Typography>\r\n            <Elements  stripe={stripePromise}>\r\n            <ElementsConsumer>\r\n                {({elements,stripe})=>(\r\n                    <form onSubmit={(e)=>handleSubmit(e,element,stripe)}>\r\n                        <CardElement/>\r\n                        <br/>\r\n                        <br/>\r\n                        <div>\r\n                            <Button variant=\"outlined\" onClick={backStep}>Back</Button>\r\n                             <Button type=\"submit\" color=\"primary\" variant=\"contained\"disable={!stripe}> Pay {checkoutToken.live.subtotal.formatted_with_symbol}</Button>\r\n                        </div>\r\n\r\n\r\n                       \r\n                    </form>\r\n\r\n                )}\r\n            </ElementsConsumer>\r\n\r\n            </Elements>\r\n\r\n        </>\r\n    )\r\n\r\n                }\r\nexport default PaymentForm"]},"metadata":{},"sourceType":"module"}