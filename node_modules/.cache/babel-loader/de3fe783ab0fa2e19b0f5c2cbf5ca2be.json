{"ast":null,"code":"import _regeneratorRuntime from\"G:\\\\MERN\\\\e-com\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"G:\\\\MERN\\\\e-com\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import React from\"react\";import{Divider,Typography,Button}from\"@material-ui/core\";import{loadStripe}from\"@stripe/stripe-js\";import{Elements,CardElement,ElementsConsumer}from\"@stripe/react-stripe-js\";import Review from\"./Review\";const PaymentForm=({checkoutToken,backStep,onCaptureCheckout,shippingData,nextStep,timeout})=>{const stripePromise=loadStripe(process.env.REACT_APP_STRIPE_KEY);const handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e,elements,stripe){var cardElement,_yield$stripe$createP,error,paymentMethod,orderData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();if(!(!stripe||!elements)){_context.next=3;break;}return _context.abrupt(\"return\");case 3:cardElement=elements.getElement(CardElement);_context.next=6;return stripe.createPaymentMethod({type:'card',card:cardElement});case 6:_yield$stripe$createP=_context.sent;error=_yield$stripe$createP.error;paymentMethod=_yield$stripe$createP.paymentMethod;if(error)console.log(error);else{orderData={line_items:checkoutToken.live.line_items,customer:{firstname:shippingData.firstName,lastname:shippingData.lastName,email:shippingData.email},shipping:{name:'International',street:shippingData.address1,town_city:shippingData.city,county_state:shippingData.shippingSubdivision,postal_zip_code:shippingData.zip,country:shippingData.shippingCountry},fulfillment:{shipping_method:shippingData.shippingOption},payment:{gateway:'stripe',stripe:{payment_method_id:paymentMethod.id}}};onCaptureCheckout(checkoutToken.id,orderData);timeout();nextStep();}case 10:case\"end\":return _context.stop();}},_callee);}));return function handleSubmit(_x,_x2,_x3){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Review,{checkoutToken:checkoutToken}),/*#__PURE__*/React.createElement(Divider,null),/*#__PURE__*/React.createElement(Typography,{variant:\"h6\",gutterBottom:true},\"Payment Method\"),/*#__PURE__*/React.createElement(Elements,{stripe:stripePromise},/*#__PURE__*/React.createElement(ElementsConsumer,null,({elements,stripe})=>/*#__PURE__*/React.createElement(\"form\",{onSubmit:e=>handleSubmit(e,elements,stripe)},/*#__PURE__*/React.createElement(CardElement,null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Button,{variant:\"outlined\",onClick:backStep},\"Back\"),/*#__PURE__*/React.createElement(Button,{type:\"submit\",color:\"primary\",variant:\"contained\",disable:!stripe},\" Pay \",checkoutToken.live.subtotal.formatted_with_symbol))))));};export default PaymentForm;","map":{"version":3,"sources":["G:/MERN/e-com/src/components/CheckoutForm/PaymentForm.jsx"],"names":["React","Divider","Typography","Button","loadStripe","Elements","CardElement","ElementsConsumer","Review","PaymentForm","checkoutToken","backStep","onCaptureCheckout","shippingData","nextStep","timeout","stripePromise","process","env","REACT_APP_STRIPE_KEY","handleSubmit","e","elements","stripe","preventDefault","cardElement","getElement","createPaymentMethod","type","card","error","paymentMethod","console","log","orderData","line_items","live","customer","firstname","firstName","lastname","lastName","email","shipping","name","street","address1","town_city","city","county_state","shippingSubdivision","postal_zip_code","zip","country","shippingCountry","fulfillment","shipping_method","shippingOption","payment","gateway","payment_method_id","id","subtotal","formatted_with_symbol"],"mappings":"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","sourcesContent":["import React from \"react\"\r\nimport {Divider, Typography, Button} from \"@material-ui/core\"\r\nimport {loadStripe} from \"@stripe/stripe-js\"\r\nimport {Elements, CardElement, ElementsConsumer} from \"@stripe/react-stripe-js\"\r\nimport Review from  \"./Review\"\r\n\r\nconst PaymentForm=({checkoutToken, backStep, onCaptureCheckout, shippingData, nextStep, timeout})=>{\r\n\r\n    const stripePromise=loadStripe(process.env.REACT_APP_STRIPE_KEY)\r\n        const handleSubmit=async(e, elements,stripe)=>{\r\n            e.preventDefault()\r\n            if(!stripe || !elements) return ;\r\n            const cardElement=elements.getElement(CardElement)\r\n            const{error,paymentMethod}=await stripe.createPaymentMethod({type:'card', card:cardElement})\r\n            if(error)\r\n             console.log(error)\r\n             else\r\n             {\r\n                const orderData = {\r\n                    line_items: checkoutToken.live.line_items,\r\n                    customer: { firstname: shippingData.firstName, lastname: shippingData.lastName, email: shippingData.email },\r\n                    shipping: { name: 'International', street: shippingData.address1, town_city: shippingData.city, county_state: shippingData.shippingSubdivision, postal_zip_code: shippingData.zip, country: shippingData.shippingCountry },\r\n                    fulfillment: { shipping_method: shippingData.shippingOption },\r\n                    payment: {\r\n                      gateway: 'stripe',\r\n                      stripe: {\r\n                        payment_method_id: paymentMethod.id,\r\n                      },\r\n                    },\r\n                  };\r\n            \r\n                  onCaptureCheckout(checkoutToken.id, orderData)\r\n                 timeout()\r\n             nextStep()\r\n             }\r\n\r\n             \r\n        }\r\n        \r\n    \r\n    return(\r\n        <>\r\n            <Review  checkoutToken={checkoutToken}/>\r\n            <Divider/>\r\n            <Typography  variant=\"h6\" gutterBottom>\r\n                Payment Method\r\n            </Typography>\r\n            <Elements  stripe={stripePromise}>\r\n            <ElementsConsumer>\r\n                {({elements,stripe})=>(\r\n                    <form onSubmit={(e)=>handleSubmit(e,elements,stripe)}>\r\n                        <CardElement/>\r\n                        <br/>\r\n                        <br/>\r\n                        <div>\r\n                            <Button variant=\"outlined\" onClick={backStep}>Back</Button>\r\n                             <Button type=\"submit\" color=\"primary\" variant=\"contained\"disable={!stripe}> Pay {checkoutToken.live.subtotal.formatted_with_symbol}</Button>\r\n                        </div>\r\n\r\n\r\n                       \r\n                    </form>\r\n\r\n                )}\r\n            </ElementsConsumer>\r\n\r\n            </Elements>\r\n\r\n        </>\r\n    )\r\n\r\n                }\r\nexport default PaymentForm"]},"metadata":{},"sourceType":"module"}